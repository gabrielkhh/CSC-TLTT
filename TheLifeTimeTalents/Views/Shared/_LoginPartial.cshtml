<div id="loadNav"></div>

<script>
    var idToken = null;
    var displayName = "";
    idToken = sessionStorage.getItem('idToken');

    if (idToken != null) {

        loadDisplayNameData();

        function loadDisplayNameData() {

            loadDisplayNameDataHandler = jQuery.ajax({
                method: 'GET',
                url: 'http://server.anythingabout.me/Account/GetUserDisplayName/',
                crossDomain: true,
                dataType: 'json',
                cache: false,
                beforeSend: function (xhr) {
                    xhr.setRequestHeader('Authorization', 'bearer ' + idToken)
                }
            })
            loadDisplayNameDataHandler.done(function (data, textStatus, jqXHR) {

                console.log(data);

                displayName = data.displayName;

                $('#loadNav').html("<form asp-area='' asp-controller='Account' asp-action='Logout' method='post' id='logoutForm' class='navbar-right'>"
                    + " <ul class='nav navbar-nav navbar-right padding-right'>"
                    + "<li>"
                    + " <a>Hello " + displayName + "!</a>"
                    + " </li>"
                    + "<li>"
                    + "<a class='page-scroll' href='/Talent/ViewTalents'>View Talents</a>"
                    + "</li >"

                    + " <li>"
                    + "  <a class='page-scroll' href='/Talent/AddTalent'>Talent Upload</a>"
                    + "</li>"
                    + "<li>"
                    + " <a class='page-scroll' href='/Home/Subscription'>Subscription</a>"
                    + "</li>"
                    + "<li class='dropdown'>"
                    + "<a href='#' id='drop' data-toggle='dropdown' class='dropdown-toggle' role='button'>"
                    + " Admin <b class='caret'></b>"
                    + " </a>"
                    + " <ul class='dropdown-menu' role='menu' aria-labelledby='drop'>"
                    + " <li>"
                    + "  <a class='page-scroll' href='/Admin/ManageSubscription'>Manage Subscription</a>"
                    + " </li>"
                    + " </ul>"
                    + "</li>"
                    + "<li>"
                    + "   <button type='submit' class='btn btn-link navbar-btn navbar-link'>Log out</button>"
                    + "</li>"
                    + "</ul>"
                    + " </form>")

            })
            loadDisplayNameDataHandler.fail(function (data, textStatus, jqXHR) {
                toastr.options = {
                    "closeButton": false,
                    "debug": false,
                    "newestOnTop": false,
                    "progressBar": false,
                    "positionClass": "toast-bottom-left",
                    "preventDuplicates": false,
                    "onclick": null,
                    "showDuration": "300",
                    "hideDuration": "1000",
                    "timeOut": "5000",
                    "extendedTimeOut": "1000",
                    "showEasing": "swing",
                    "hideEasing": "linear",
                    "showMethod": "fadeIn",
                    "hideMethod": "fadeOut"
                }
                toastr["error"]("There was an issue retrieving data from the server.", "Error")
            })
        }
    }
    else {
        $('#loadNav').html("<form class='navbar-right'>"
            + " <ul class='nav navbar-nav navbar-right padding-right'>"
            + "<li>"
            + "<a class='page-scroll' href='/Talent/ViewTalents'>View Talents</a>"
            + "</li >"
            + "<li><a asp-area='' href='/Account/Register'>Register</a></li >"
            + "<li><a asp-area='' href='/Account/Login'>Log in</a></li>"
            + "</ul>"
            + "</form>")
    }
</script>
