@{
    ViewData["Title"] = "Admin";
}

<div class="container body-content">
    <h2>@ViewData["Title"].</h2>


    <div class="col-md-6 pull-left">
        <form id="myForm" class="form-horizontal smaller-width">
            <div class="row">
                <h4>Manage Subscription plans.</h4>
            </div>
            <hr />

            <div class="form-group">
                <label class="control-label orange-text">Plan 1</label>
                <div class="row">
                    <br />
                    <label class=" pull-left control-label padding-left ">Name</label>
                    <div class="col-md-5">
                        <input type="text" id="txtPlanName1" name="txtPlanName1" class="form-control" />
                    </div>

                    <label class=" pull-left control-label padding-left">Price</label>
                    <div class="col-md-2">
                        <input type="text" id="txtPlanPrice1" name="txtPlanPrice1" class="form-control" />
                    </div>

                </div>
            </div>

            <div class="form-group">
                <label class="control-label orange-text">Plan 2</label>
                <div class="row">
                    <br />
                    <label class=" pull-left control-label padding-left">Name</label>
                    <div class="col-md-5">
                        <input type="text" id="txtPlanName2" name="txtPlanName2" class="form-control" />
                    </div>

                    <label class=" pull-left control-label padding-left">Price</label>
                    <div class="col-md-2">
                        <input type="text" id="txtPlanPrice2" name="txtPlanPrice2" class="form-control" />
                    </div>

                </div>
            </div>

            <div class="form-group">
                <label class="control-label orange-text">Plan 3</label>
                <div class="row">
                    <br />
                    <label class=" pull-left control-label padding-left">Name</label>
                    <div class="col-md-5">
                        <input type="text" id="txtPlanName3" name="txtPlanName3" class="form-control" />
                    </div>

                    <label class=" pull-left control-label padding-left">Price</label>
                    <div class="col-md-2">
                        <input type="text" id="txtPlanPrice3" name="txtPlanPrice3" class="form-control" />
                    </div>

                </div>
            </div>

            <div class="form-group">
                <div class="col-md-offset-2 col-md-10">
                    <button id="btnSave" type="submit" class="btn btn-default">Save</button>
                </div>
            </div>
        </form>
    </div>

</div>

<script>
    var accessToken = sessionStorage.getItem('accessToken');

    //loadPlanData();

    function loadPlanData() {

        loadPlanDataHandler = jQuery.ajax({
            method: 'GET',
            url: 'http://server.anythingabout.me/Account/Register',
            crossDomain: true,
            dataType: 'json',
            cache: false,
            beforeSend: function (xhr) {
                xhr.setRequestHeader('Authorization', 'bearer ' + accessToken)
            }
        })
        loadPlanDataHandler.done(function (data, textStatus, jqXHR) {

            console.log(data);

        })
        loadPlanDataHandler.fail(function (data, textStatus, jqXHR) {
            toastr.options = {
                "closeButton": false,
                "debug": false,
                "newestOnTop": false,
                "progressBar": false,
                "positionClass": "toast-bottom-left",
                "preventDuplicates": false,
                "onclick": null,
                "showDuration": "300",
                "hideDuration": "1000",
                "timeOut": "5000",
                "extendedTimeOut": "1000",
                "showEasing": "swing",
                "hideEasing": "linear",
                "showMethod": "fadeIn",
                "hideMethod": "fadeOut"
            }
            toastr["error"]("There was an issue retrieving data from the server.", "Error")
        })
    }

    $(document).ready(function () {

        $("#btnSave").click(function () {

            event.preventDefault();

            function WebFormData(inPlanName1) {
                this.planName1 = inPlanName1;
            }

            collectedPlanName1 = $('#txtPlanName1').val();

            var webFormData = new WebFormData(collectedPlanName1);

            var webFormDataInString = JSON.stringify(webFormData);

            console.log(webFormDataInString);

            $saveHandler = jQuery.ajax({
                type: 'POST',
                url: 'http://server.anythingabout.me/Account/Register',
                crossDomain: true,
                data: webFormDataInString,
                dataType: 'json',
                contentType: 'application/json',
                beforeSend: function (xhr) {
                    xhr.setRequestHeader('Authorization', 'bearer ' + accessToken)
                }
            });

            $saveHandler.done(function (data, textStatus, jqXHR) {
                swal({
                    title: "Successful!",
                    text: "Subscription Fee Updated!",
                    type: "success"
                },
                    function () {
                        ignore = true;
                        window.location.replace("/Admin/ManageSubscription");
                    });
            });

            $saveHandler.fail(function (data, textStatus, jqXHR) {
                toastr.options = {
                    "closeButton": false,
                    "debug": false,
                    "newestOnTop": false,
                    "progressBar": false,
                    "positionClass": "toast-bottom-left",
                    "preventDuplicates": false,
                    "onclick": null,
                    "showDuration": "300",
                    "hideDuration": "1000",
                    "timeOut": "5000",
                    "extendedTimeOut": "1000",
                    "showEasing": "swing",
                    "hideEasing": "linear",
                    "showMethod": "fadeIn",
                    "hideMethod": "fadeOut"
                }

                toastr["error"](jqXHR, "Error")
            });
        });
    });
</script>